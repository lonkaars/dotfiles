#!/bin/sh
PREFIX="$XDG_CACHE_HOME/mode/chromium"

mkdir -p "$PREFIX"
rm -f "$PREFIX/Cached Theme.pak"

magick -size 100x100 "xc:$bg" "$PREFIX/bg.png"
bg_alt=$(mix_rgb $color7 $bg 0.20)
fg_alt=$(mix_rgb $color15 $fg 0.60)
bg="$(hex_to_rgb_array "$bg")"
fg="$(hex_to_rgb_array "$fg")"
bg_alt="$(hex_to_rgb_array "$bg_alt")"
fg_alt="$(hex_to_rgb_array "$fg_alt")"
cat << EOF > "$PREFIX/manifest.json"
{
	"description": "colorscheme generated by mode",
	"manifest_version": 2,
	"name": "mode theme",
	"theme": {
		"images": { "theme_frame": "bg.png" },
		"colors": {
			"frame": $bg,
			"button_background": $fg,
			"ntp_background": $bg,
			"ntp_text": $bg,
			"toolbar": $bg_alt,
			"toolbar_button_icon": $fg,
			"tab_background_text": $fg_alt,
			"tab_background_text_inactive": $fg_alt,
			"tab_background_text_incognito": $fg_alt,
			"tab_background_text_incognito_inactive": $fg_alt,
			"bookmark_text": $fg,
			"tab_text": $fg
		},
		"tints": {
			"buttons": [ -1, -1, -1 ],
			"frame_inactive": [ -1, -1, -1 ],
			"frame_incognito": [ -1, -1, -1 ],
			"frame_incognito_inactive": [ -1, -1, -1 ]
		}
	},
	"version": "2"
}
EOF

