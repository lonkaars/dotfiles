#!/bin/sh
mkcd "$XDG_CACHE_HOME/mode/chromium"

rm -f 'Cached Theme.pak'

magick -size 100x100 "xc:$bg" 'bg.png'
bg_alt=$(mix_rgb $bg $color0 0.65)
fg_alt=$(mix_rgb $fg $color15 0.35)
bg="$(hex_to_rgb_array "$bg")"
fg="$(hex_to_rgb_array "$fg")"
bg_alt="$(hex_to_rgb_array "$bg_alt")"
fg_alt="$(hex_to_rgb_array "$fg_alt")"
cat << EOF > 'manifest.json'
{
	"description": "colorscheme generated by mode",
	"manifest_version": 2,
	"name": "mode theme",
	"theme": {
		"images": { "theme_frame": "bg.png" },
		"colors": {
			"frame": $bg,
			"button_background": $fg,
			"ntp_background": $bg,
			"ntp_text": $bg,
			"toolbar": $bg_alt,
			"toolbar_button_icon": $fg,
			"tab_background_text": $fg_alt,
			"tab_background_text_inactive": $fg_alt,
			"tab_background_text_incognito": $fg_alt,
			"tab_background_text_incognito_inactive": $fg_alt,
			"bookmark_text": $fg,
			"tab_text": $fg
		},
		"tints": {
			"buttons": [ -1, -1, -1 ],
			"frame_inactive": [ -1, -1, -1 ],
			"frame_incognito": [ -1, -1, -1 ],
			"frame_incognito_inactive": [ -1, -1, -1 ]
		}
	},
	"version": "2"
}
EOF

